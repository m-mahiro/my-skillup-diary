これから短い作業計画（Todo）を作成して作業を進めます — 目的: 作成・レビューの進捗管理。完了したら更新します。

Created 3 todos

次に、作業を完了に更新します — 何をするか: 作成したTodoの状態を「完了」に変更して進捗を記録します。期待する結果: すべての項目が完了としてマークされます。

Completed (1/3) *アウトライン作成*

## 概要
`dig`（Domain Information Groper）は、DNSクエリ（名前解決情報）を手動で実行・デバッグするためのコマンドラインツールです。指定したDNSサーバーに対して任意のレコードタイプを問い合わせたり、DNSの伝播や権威サーバーまでの経路をたどったりできます。主にネットワーク管理者や開発者がDNSのトラブルシューティングに使います。

## 使い方（基本構文）
digの基本構文は次の通りです：
```bash
dig [@サーバー] 名前 [タイプ] [オプション]
```
- @サーバー: 問い合わせ先のDNSサーバー（例: @8.8.8.8）。省略するとシステムのデフォルトリゾルバを使う。
- 名前: ドメイン名またはIP（リバースは -x を使う）。
- タイプ: A, AAAA, MX, NS, SOA, TXT, CNAME, PTR, ANY など。省略すると A（通常）を問い合わせる。
- オプション: 出力フォーマットや挙動を制御するフラグ（下記参照）。

## よく使うオプションと意味
- @server : 指定DNSサーバーへ問い合わせ（例: `@8.8.8.8`）
- -x IP : 逆引き（PTR）問い合わせのショートカット（例: `dig -x 1.2.3.4`）
- +short : 結果を簡潔に表示（スクリプト向け）
- +noall +answer : 標準的な出力を抑えて回答セクションのみ表示
- +trace : ルートから権威サーバーまで辿る（デバッグ用）
- +tcp : TCPで問い合わせ（既定はUDP）
- +time=N : タイムアウト秒（デフォルトはシステム依存）
- +tries=N : 再試行回数
- -p ポート番号 : DNSポートを指定（例: `-p 5353`）
- +dnssec : DNSSEC情報要求
- +cdflag : DNSSECの検証を無効に（チェックバイパス）
- +nocmd / +nocomments : ヘッダやコメントを抑える

（補足）出力に表示される代表フィールド：
- QUESTION SECTION : 問い合わせ内容
- ANSWER SECTION : 回答（レコードとTTLなど）
- AUTHORITY / ADDITIONAL : 権威や追加情報
- flags: qr, aa, rd, ra, ad, cd など（問い合わせのフラグ）

## 代表的な例（すぐ試せるコマンド）
簡単なAレコード問い合わせ（デフォルトのDNSで）
```bash
dig example.com
```

Google Public DNSに問い合わせ（Aレコード）
```bash
dig @8.8.8.8 example.com A
```

結果だけを短く（スクリプト向け）
```bash
dig +short example.com
```

MXレコードだけを簡潔に表示
```bash
dig +short example.com MX
# または
dig example.com MX +noall +answer
```

逆引き（PTR）
```bash
dig -x 93.184.216.34
```

ルートからトレースして権威サーバーまで追う
```bash
dig +trace example.com
```

TCPで問い合わせ（大きい応答やADの検証）
```bash
dig +tcp example.com
```

タイムアウト・再試行を制御
```bash
dig +time=2 +tries=1 example.com
```

指定ポートで問い合わせ（カスタムDNSサーバーをテスト）
```bash
dig @127.0.0.1 -p 5353 example.com A
```

DNSSEC情報を要求
```bash
dig example.com +dnssec
```

## 出力の読み方（簡単）
digは複数セクションからなる標準出力を出します。典型的には：
- ヘッダ（コマンド実行情報） — 実行したクエリなど
- QUESTION SECTION — 問い合わせたドメイン/タイプ
- ANSWER SECTION — 実際の回答（ここにA/AAAA/MXなどが出る）
- AUTHORITY / ADDITIONAL — 追加情報や権威情報
- 最後に統計（Query time, SERVER, WHEN など）

スクリプトで使う場合は `+short` や `+noall +answer` を使って必要情報だけ抽出すると扱いやすいです。

## よくある用途とヒント
- DNS変更の伝播確認：TTL値を見て、適切にキャッシュされているか確認する。
- 特定のリゾルバでの結果確認：`@resolver` を使ってISPやGoogleの応答差を比較する。
- 権威サーバーの確認：`dig NS example.com` と、各NSに直接問い合わせる（`@ns1.example.net`）ことで正しい権威応答かを確認。
- MX経路の確認：`dig MX example.com +short` で受信メールの優先順位を確認。
- リバースとフォワードの一致確認：サーバーのIPで `-x` を実行し、得られたホスト名を通常問い合わせしてAレコードと一致するか検査する。
- トラブルシューティング：`+trace` や `+tcp`、`+dnssec` を組み合わせて問題箇所を絞る。

## トラブルシューティングの短いコツ
- 応答がない/タイムアウトする → `+time` や `+tries` を増やす、`@別サーバ`で試す。
- 期待するレコードが返らない → まず権威サーバーに直接問い合わせる（`@ns...`）。
- 本番反映前にTTLを短くしておく（変更時の伝播を速める）。
- DNSキャッシュの影響を見るには、異なるネットワーク（ISPのDNSやモバイル）での結果も比較する。

## まとめ（実用的な小さなルール）
- スクリプトで使うなら `+short`／`+noall +answer` を常用。
- 特定のサーバーの挙動を見るなら `@server` を指定。
- 権威情報や伝播を追うなら `+trace`／権威サーバーへの直接問い合わせ。
- DNSSECやTCPが必要な場面（大きな応答やセキュリティ確認）では `+dnssec` / `+tcp` を使う。

完了: digの基本的な使い方、主要オプション、代表例、読み方とトラブルシューティング要点をまとめました。さらに特定のユースケース（たとえばスクリプトでのパース例やDNSSEC詳細、bind9のdigのバージョン差）を掘り下げたい場合は教えてください。